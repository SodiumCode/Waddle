<root><head><waddleversion>0</waddleversion><dataversion>0</dataversion></head><body><blocks><xml xmlns="https://developers.google.com/blockly/xml"><block type="vw_defTypes" id="#($p`(B0gLMeNNqP9=%v" x="263" y="255"><field name="type">HTML_WIDGET</field><field name="icon">https://waddle.coco-central.cn/static/img/logo/logo-white.svg</field><field name="title">HTML控件</field><field name="version">1.2.0</field><field name="width">200</field><field name="height">150</field><next><block type="vw_defWidget" id="vPD/UG[D8!mHTmj5n.x["><statement name="constructor"><block type="js_console_log" id="d(3@7[TgaNp@~(ePZS{`"><value name="TEXT"><block type="text" id="Ns=y!Cn0)|SCM@?0@n~x"><field name="TEXT">本控件通过Waddle制作</field></block></value><next><block type="js_console_log" id="`Im`S)40z[W=48A5;|hM"><value name="TEXT"><block type="text" id="n:0I3i[pUnitGUXgk,:}"><field name="TEXT">控件作者：中子星000（QQ：2422481178）</field></block></value><next><block type="widget_widgetlog" id=":XI16a3f1_3,(g-u*j5z"><value name="value"><block type="text" id=":e@Ro7MPtq+%RO*YUqrh"><field name="TEXT">本控件通过Waddle制作</field></block></value><next><block type="widget_widgetlog" id="~YBH~(Wcii!4jhHy@4##"><value name="value"><block type="text" id="8?2_/cF*2XCz@anj^Q:+"><field name="TEXT">控件作者：中子星000（QQ：2422481178）</field></block></value><next><block type="ivw_propsinit" id="=6$Kl9W.D+oFJ1im18Tf"><field name="props_name">content</field></block></next></block></next></block></next></block></next></block></statement><statement name="render"><block type="vw_returnrender" id="F#xc23MhHgNJ@vp)#3fz"><statement name="HTML"><block type="html_html" id="MHih#UGm;FQ}gz!-8ht~"><value name="NAME"><block type="ivw_getproperty" id="f#_hk[Nnq^t/0hCR*J:~"><field name="KEY">content</field></block></value><statement name="PRO"><block type="html_attribute_event" id="rd*@o]#_fAbBZe$(kSpv"><field name="eventName">onClick</field><field name="widgetEventName">onClick</field><next><block type="html_attribute_style" id="^)z?)ND0Bx?.Et;9BV1d"><statement name="CON"><block type="html_css" id="q,MGN9!TC.6u7)^Zd3zb"><field name="NAME">width</field><value name="VAL"><block type="html_other_%" id="DIukLKmq1TG`Ze_fMA+K"><value name="VAL"><shadow type="math_number" id="x;Kl2(VjEKf5tm$EDa?l"><field name="NUM">100</field></shadow></value></block></value><next><block type="html_css" id="UEE|_]Jv*928D+@vR?B-"><field name="NAME">height</field><value name="VAL"><block type="html_other_%" id="46ST(Kg:A.tL,!Qk51bZ"><value name="VAL"><shadow type="math_number" id="L9*Lazqn0q!D;/,))H[U"><field name="NUM">100</field></shadow></value></block></value></block></next></block></statement></block></next></block></statement></block></statement></block></statement><next><block type="vw_addEvent" id=";p2Zi.e._`!QdX5cF-0m" inline="true"><field name="label">被点击</field><field name="key">onClick</field><statement name="code"><block type="ivw_emit" id="a4`1kK,eHq^-KP0C3Qa="><field name="event">onClick</field></block></statement><next><block type="ivw_addProperty" id="70K{uUc`SuKOfO[S):2/"><field name="label">HTML文本</field><field name="key">content</field><field name="valueType">multilineString</field><value name="defaultValue"><block type="text" id="Oyh2ZIcM/_yI!sWpy@IO"><field name="TEXT">&lt;a href="https://coco-central.cn/"&gt;Hello, CoCo!&lt;/a&gt;</field></block></value><value name="config"><block type="ivw_config" id="zWclrRO.#w;}Tu;G`xWx"><field name="icon">无</field><field name="generateBlock">FALSE</field><field name="inputsInline">TRUE</field><field name="space">16</field><value name="color"><shadow type="colour_picker" id="rpH*o)2%[gqCmRV:AExq"><field name="COLOUR">#ffbb55</field></shadow></value></block></value><next><block type="ivw_addMethod" id="h=N%#woDdT]l3:Vn+v`Y"><field name="label">获取HTML文本</field><field name="key">get_content</field><field name="valueType">'string'</field><statement name="code"><block type="ivw_methodReturn" id="cfj,cB+BDu,Td*l/T.;]"><value name="value"><block type="ivw_getproperty" id="{yS2YS1@-06Se=]D@iIv"><field name="KEY">content</field></block></value></block></statement><next><block type="ivw_addMethod" id="q,]74(lc4=%+-^W96Xgh"><field name="label">设置HTML文本</field><field name="key">set_content</field><field name="valueType">noReturn</field><statement name="params"><block type="ivw_addParams" id="%Le(O|gIhsv32ShMdU,K"><field name="label">文本</field><field name="key">content</field><field name="valueType">'multilineString'</field><value name="defaultValue"><block type="text" id="LDia;7Bv[nP2ptgH5M?:"><field name="TEXT">&lt;a href="https://coco-central.cn/"&gt;Hello, CoCo!&lt;/a&gt;</field></block></value></block></statement><statement name="code"><block type="vw_setprop" id="?*%@S,]_ck}@`VgcBRdN"><field name="name">content</field><value name="value"><block type="ivw_getparam" id="vHlPCiqdyQF%NE9tk1I|"><field name="KEY">content</field></block></value></block></statement><next><block type="ivw_addMethod" id="jX]*+;be_G]-*G0!qRM."><field name="label">HTML防注入</field><field name="key">html_decode_and_encode</field><field name="valueType">'string'</field><statement name="params"><block type="ivw_addParams" id="dYK`f;}9Y}BxXC+?WJme"><field name="label">文本</field><field name="key">text</field><field name="valueType">'multilineString'</field><value name="defaultValue"><block type="text" id="^IE*~K?);ob:a_+rQAjT"><field name="TEXT">&lt;a href="https://coco-central.cn/"&gt;Hello, CoCo!&lt;/a&gt;</field></block></value></block></statement><statement name="code"><block type="ivw_methodReturn" id="F:WHt_E5rB/.2TgUqp9b"><value name="value"><block type="js_replace" id="O`UDNU[?yEh{(PWYlclu" inline="false"><field name="MODE">replaceAll</field><value name="STR"><block type="js_replace" id="+xo^_G^$Q=QZiv;nahW@" inline="false"><field name="MODE">replaceAll</field><value name="STR"><block type="js_replace" id="I?#G(YRYre7^f[*B44dX" inline="false"><field name="MODE">replaceAll</field><value name="STR"><block type="ivw_getparam" id="zT6YKDaU@L/^I/vP~tF`"><field name="KEY">text</field></block></value><value name="STR1"><block type="text" id="gN5eX|dO]]S@KGCWXolU"><field name="TEXT">&amp;</field></block></value><value name="STR2"><block type="text" id="-gY:f[sy{Ti?k!h*3iN6"><field name="TEXT">&amp;amp;</field></block></value></block></value><value name="STR1"><block type="text" id="RP#4jwXz5LEy;gR3yJZr"><field name="TEXT">&lt;</field></block></value><value name="STR2"><block type="text" id="sieSUoT*FCv!PqN[=$rJ"><field name="TEXT">&amp;lt;</field></block></value></block></value><value name="STR1"><block type="text" id="D(k+exas;g_{mIBVqwyC"><field name="TEXT">&gt;</field></block></value><value name="STR2"><block type="text" id="z2Ii0f1$!zY#QFbQXx)]"><field name="TEXT">&amp;gt;</field></block></value></block></value></block></statement><value name="config"><block type="ivw_config" id="EgFpt}@2](HJvt4`#?fr"><field name="icon">无</field><field name="generateBlock">TRUE</field><field name="inputsInline">TRUE</field><field name="space">16</field><value name="color"><shadow type="colour_picker" id="lX;|V9XeA[|$v.myL~G9"><field name="COLOUR">#ffbb55</field></shadow><block type="colour_rgb" id="!r.9{ShQ|gS7.ZQe|nv%"><value name="RED"><shadow type="math_number" id="?V]wM]ClI{8n^=|)Ar~*"><field name="NUM">254</field></shadow></value><value name="GREEN"><shadow type="math_number" id="hWWouTMxm8hOI#BLyF,s"><field name="NUM">174</field></shadow></value><value name="BLUE"><shadow type="math_number" id="[ygArI7hg!Xk!HC8:-|]"><field name="NUM">138</field></shadow></value></block></value></block></value><next><block type="ivw_export" id="9XvRlww2v`Y)Y,zKVRPn"></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></xml></blocks><js>function colourRgb(r, g, b) {
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}



const types = {
  isInvisibleWidget: false,
  type: "HTML_WIDGET",
  icon: "https://waddle.coco-central.cn/static/img/logo/logo-white.svg",
  title: "HTML控件",
  version: "1.2.0",
  isGlobalWidget: false,
  properties: [
    {
      key: '__width',
      label: '宽度',
      valueType: 'number',
      defaultValue: 200,
      blockOptions: {
        generateBlock: false,
      },
    },
    {
      key: '__height',
      label: '高度',
      valueType: 'number',
      defaultValue: 150,
      blockOptions: {
        generateBlock: false,
      },
    },
    {
      key: '__size',
      label: '',
      valueType: 'number',
      defaultValue: 0,
      readonly: true,
      blockOptions: {
        setter: {
          keys: ['__height', '__width'],
        },
        getter: {
          keys: ['__height', '__width'],
        },
      },
    },
  ],
  methods: [],
  events: [],
};

class Widget extends VisibleWidget {
  constructor(props) {
    super(props);
    this.__width = props.__width;
    this.__height = props.__height;
    console.log('本控件通过Waddle制作');
  console.log('控件作者：中子星000（QQ：2422481178）');
  this.widgetLog('本控件通过Waddle制作');
  this.widgetLog('控件作者：中子星000（QQ：2422481178）');
  this.content=props.content;

  }
  render() {
    return(
      React.createElement("div", {  onClick: this.onClick.bind(this),
      style: {  width: "100%",
        height: "100%",
      },
    dangerouslySetInnerHTML: {__html: (this.content)}}, null)
  );

  }
}

types['events'].push({
    key: 'onClick',
    label: '被点击',
    params: [],

})
Widget.prototype.onClick = function (event) {
      this.emit("onClick");
}

types['properties'].push({
    key: 'content',
    label: 'HTML文本',
    valueType: 'string',
    editorType: 'TextArea',
    defaultValue: '<a href="https://coco-central.cn/">Hello, CoCo!</a>',
    blockOptions: {
    color: '#ffbb55',
    icon: '无',
    generateBlock: false,
    inputsInline: true,
    space: 16,
},
})

types['methods'].push({
    key: 'get_content',
    label: '获取HTML文本',
    params: [],
    valueType: 'string',

})
Widget.prototype.get_content = function () {
      return (this.content);
}
types['methods'].push({
    key: 'set_content',
    label: '设置HTML文本',
    params: [
      {
          key: 'content',
          label: '文本',
          valueType: 'multilineString',
      checkType: 'string',
          defaultValue: '<a href="https://coco-central.cn/">Hello, CoCo!</a>',
      },],


})
Widget.prototype.set_content = function (content,) {
      this.setProps({ 'content': content });

}
types['methods'].push({
    key: 'html_decode_and_encode',
    label: 'HTML防注入',
    params: [
      {
          key: 'text',
          label: '文本',
          valueType: 'multilineString',
      checkType: 'string',
          defaultValue: '<a href="https://coco-central.cn/">Hello, CoCo!</a>',
      },],
    valueType: 'string',
    blockOptions: {
    color: (colourRgb(254, 174, 138)),
    icon: '无',
    generateBlock: true,
    inputsInline: true,
    space: 16,
},
})
Widget.prototype.html_decode_and_encode = function (text,) {
      return (text.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'));
}
exports.types = types;
exports.widget = Widget;
</js></body></root>